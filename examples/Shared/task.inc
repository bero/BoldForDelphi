(*****************************************************)
(*                                                   *)
(*  Bold for Delphi Stub File                        *)
(*                                                   *)
(*  Autogenerated file for method implementations    *)
(*                                                   *)
(*****************************************************)

//
{$INCLUDE DemoClasses_Interface.inc}

var
  FTaskCounter: Integer = 0;

class procedure TTask.InitializeCounter(ASystem: TBoldSystem);
var
  Tasks: TBoldObjectList;
  i, Num, MaxNum: Integer;
  TaskTitle: string;
begin
  MaxNum := 0;
  Tasks := ASystem.Classes[ASystem.BoldSystemTypeInfo.ClassTypeInfoByExpressionName['Task'].TopSortedIndex];
  for i := 0 to Tasks.Count - 1 do
  begin
    TaskTitle := TTask(Tasks[i]).Title;
    if TaskTitle.StartsWith('Task') then
    begin
      if TryStrToInt(Copy(TaskTitle, 5, MaxInt), Num) then
        if Num > MaxNum then
          MaxNum := Num;
    end;
  end;
  FTaskCounter := MaxNum;
end;

procedure TTask.CompleteCreate;
begin
  inherited;
  Inc(FTaskCounter);
  Title := 'Task' + IntToStr(FTaskCounter);
end;
